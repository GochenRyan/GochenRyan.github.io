---
title: ã€æ¸¸æˆå®¢æˆ·ç«¯ã€‘è¯»å–å¹¶ç»˜åˆ¶å›¾å—åœ°å›¾
date: 2020-05-11 01:49:28
tags:
    - æ¸¸æˆå®¢æˆ·ç«¯
    - tiled
    - ã€ŠC++æ¸¸æˆç¼–ç¨‹ï¼šåˆ›å»º3Dæ¸¸æˆã€‹
---

## å‰è¨€
è¿™ç¯‡æ–‡ç« æ˜¯ã€ŠC++æ¸¸æˆç¼–ç¨‹ï¼šåˆ›å»º3Dæ¸¸æˆã€‹ç¬¬äºŒç« çš„ç»ƒä¹ é¢˜3çš„é¢˜è§£ã€‚çœ‹äº†çœ‹Gihubçš„æäº¤è®°å½•ï¼Œå·²ç»æ˜¯4æœˆ13å·çš„äº‹äº†ã€‚ä½œä¸ºä¸€åæœ‰ç¾è€»å¿ƒçš„æ‡’ç™Œç—‡æ‚£è€…ï¼Œæˆ‘ä¼šè¿Ÿåˆ°ï¼Œä½†æˆ‘æ°¸è¿œä¸ä¼šç¼ºå¸­......

<!-- more -->

## æ€è€ƒ
å…ˆçœ‹ä¸€ä¸‹é¢˜ç›®ğŸ¤”ï¼š
![20200511001300-image.png](/img/GameProgramInCpp/1.png)
æ„Ÿè§‰å’Œé¡¹ç›®ä¸­ç»å¸¸ä½¿ç”¨çš„å¯¼è¡¨å¾ˆåƒï¼Œéƒ½æ˜¯è¯»å–ç¼–è¾‘å™¨ç”Ÿæˆçš„**ç‰¹å®šæ ¼å¼**çš„æ–‡æ¡£ï¼Œç„¶åç¼–å†™è§£æç¨‹åºè¯»å–å¹¶è¾“å‡ºï¼Œä¸è¿‡å¯¼è¡¨æ˜¯ç”Ÿæˆ**pyæ–‡ä»¶**ï¼Œè¿™é‡Œæ˜¯**ç»˜åˆ¶çº¹ç†**ï¼ˆä¹Ÿå°±ä¸€ä¸ª`SDL_RenderCopyEx`å°±èƒ½è§£å†³çš„äº‹ï¼‰ã€‚
æ‰€ä»¥æ€è·¯åº”è¯¥æ˜¯è¿™æ ·ï¼š**åˆ†æcsvæ–‡ä»¶æ ¼å¼**>**è¯»å–æœ‰æ•ˆæ•°æ®**>**æ ¹æ®æ˜ å°„å…³ç³»ç»˜åˆ¶çº¹ç†**

## ç¼–ç¨‹
å¯¹C++ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼ŒGoogleä¸€ä¸‹ï¼š**C++å¦‚ä½•è¯»å–CSVæ–‡ä»¶ï¼Ÿ**
go onğŸ˜€

### åˆ†æcsvæ–‡ä»¶æ ¼å¼
ä¸è¦ç”¨**exce**læ‰“å¼€ï¼Œç›´æ¥ç”¨è®°äº‹æœ¬æ‰“å¼€å¯ä»¥çœ‹åˆ°æ ¼å¼
![20200511004253-image.png](/img/GameProgramInCpp/2.png)
è¡Œä¸è¡Œä¹‹é—´ç”¨å›è½¦åˆ†éš”ï¼Œæ¯ä¸€è¡Œçš„æ•°å­—ç´¢å¼•éƒ½ç”¨","åˆ†éš”ã€‚

### è¯»å–æœ‰æ•ˆæ•°æ®
è¿™é‡Œæ ¹æ®æ•°æ®æ ¼å¼çš„ç‰¹ç‚¹ï¼Œç›´æ¥è¯»å–éœ€è¦çš„æ•°å­—ç´¢å¼•ã€‚
```cpp
std::ifstream fin(tilemap.csvName);
std::string line;

std::vector<std::vector<int>> fields;
while (getline(fin, line))
        {
            std::istringstream sin(line);
            std::vector<int> rowContent;
            std::string field;
            while (getline(sin, field, ','))
            {
                rowContent.push_back(std::stoi(field));
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }

            fields.push_back(rowContent);
        }
```

### æ ¹æ®æ˜ å°„å…³ç³»ç»˜åˆ¶çº¹ç†
è¿™é‡Œéœ€è¦å…³æ³¨çš„æ˜¯**å¤§å°**ã€**ä½ç½®**ï¼ŒeasyğŸ˜‹ã€‚
* å¤§å°ï¼šå®½åº¦é™¤ä»¥åˆ—æ•°ã€é«˜åº¦é™¤ä»¥è¡Œæ•°
* ä½ç½®ï¼šå› ä¸ºéœ€è¦çš„æ˜¯**å·¦ä¸Šè§’**çš„åæ ‡ï¼Œéå†çš„æ—¶å€™ç›´æ¥åˆ—åºå·xå®½åº¦ã€è¡Œåºå·xé«˜åº¦

```cpp
rows = fields.size();
cols = fields[0].size();
for (int i = 0; i < fields.size(); i++) {
    for (int j = 0; j < fields[i].size(); j++) {
        if (fields[i][j] == -1) continue;
        tile.w = static_cast<int>(mTextureWidth / mTileCols);
        tile.h = static_cast<int>(mTextureHeight / mTileRows);
        tile.x = (fields[i][j] % mTileCols) * tile.w;
        tile.y = (fields[i][j] / mTileCols) * tile.h;
        r.w = static_cast<int>(mScreenSize.x / cols);
        r.h = static_cast<int>(mScreenSize.y / rows);
        // Center the rectangle around the position of the owner
        r.x = r.w * j;
        r.y = r.h * i;
        // Draw this tile
        SDL_RenderCopyEx(
            renderer, 
            mTexture, 
            &tile, 
            &r, 
            -Math::ToDegrees(mOwner->GetRotation()),
            nullptr,
            SDL_FLIP_NONE
        );
    }
}
```
ç»˜åˆ¶å‡ºæ¥å°±æ˜¯è¿™ä¸ªæ ·å­ï¼š
![20200511013654-image.png](/img/GameProgramInCpp/3.png)
å¾ˆæœ‰å¹´ä»£æ„ŸğŸ¤£ï¼Œå®Œæ•´çš„ä»£ç å¯ä»¥åœ¨[æˆ‘çš„ä»“åº“](https://github.com/GochenRyan/GameProgrammingInCPlus/tree/master/Chapter2/Practice_2_tilemap)æ‰¾åˆ°ã€‚

## æœ€å
emmmï¼Œç”±äºç å®Œä¹‹åç›´æ¥ç¡è§‰äº†ï¼Œæ‰€ä»¥ä¸€äº›**å¼‚å¸¸è¾“å…¥**ï¼ˆcsvæ–‡ä»¶æ¯è¡Œä¸ªæ•°ä¸ä¸€è‡´ã€ç´¢å¼•ä¸æ˜¯æ•°å­—ç­‰ï¼‰æ²¡æœ‰è€ƒè™‘åˆ°ï¼Œåç»­ä¼šä¼˜åŒ–çš„ğŸ˜‘ï¼Œæ¬¢è¿ç»™æˆ‘æissueã€‚


